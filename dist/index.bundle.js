(()=>{"use strict";var e,t={44:(e,t,n)=>{var o=n(223),i=n(405),a=n(353),s=n.n(a),l=n(826),r=n.n(l),c=n(569),d=n.n(c),u=n(445),v=n.n(u);e=n.hmd(e),s().extend(r()),s().extend(d()),s().extend(v());const m=s().tz.guess();(0,o.Wp)({apiKey:"AIzaSyDChyRMRZw13CIheI4_vd5bsrFLBprMC20",authDomain:"that-sky-calendar-ffd49.firebaseapp.com",projectId:"that-sky-calendar-ffd49",storageBucket:"that-sky-calendar-ffd49.appspot.com",messagingSenderId:"994867085966",appId:"1:994867085966:web:ea6d5b05bccb508eb73fdf",measurementId:"G-FXXSH6NS6Z"});const p=(0,i.aU)(),g=(0,i.rJ)(p,"events");let h=[];function y(e,t,n,o,i){const a=document.createElement("div");return a.className=`event-notice ${t}`,a.innerHTML=`\n      <div class="notice-icon">\n        <img src="${n}" alt="${t} event icon">\n      </div>\n      <div class="notice-text">\n        <p><strong>${o}</strong> <u>${e.title}</u> ${i}</p>\n      </div>\n    `,a}function f(e){const t=e?.toLowerCase()||"";return t.includes("traveling")||t.includes("ts")?{class:"ts",text:"TS"}:t.includes("season")?{class:"season",text:"SEASON"}:t.includes("special")?{class:"special",text:"SPECIAL"}:t.includes("shard")?{class:"shards",text:"SHARDS"}:{class:"special",text:"EVENT"}}function w(e,t){const n={month:"short",day:"numeric"},o=e.toLocaleDateString("en-US",n),i=t.toLocaleDateString("en-US",n);if(e.getMonth()===t.getMonth()){const n=e.getDate(),o=t.getDate();return`${e.toLocaleDateString("en-US",{month:"short"})} ${n} - ${o}`}return`${o} - ${i}`}function b(e,t,n){const o=864e5,i=36e5;let a,s,l;if(n<e)a=e-n,s="Starts in",l="starting";else{if(!(n>=e&&n<=t))return{class:"ended",label:"Event",time:"Ended"};a=t-n,s="Ends in",l="ending"}const r=Math.floor(a/o),c=Math.floor(a%o/i),d=Math.floor(a%i/6e4);let u="";return u=r>0?`${r}d ${c}h ${d}m`:c>0?`${c}h ${d}m`:d>0?`${d}m`:"Now",{class:l,label:s,time:u}}Promise.all([(0,i.GG)((0,i.P)(g,(0,i.My)("start","asc")))]).then((([e])=>{const t=[];e.docs.forEach((e=>{const n=(e.data().start||"").trim(),o=(e.data().end||"").trim(),i=e.data().startTime;let a,l;if(i){a=s().tz(`${n} ${i}`,"YYYY-MM-DD HH:mm","America/Los_Angeles");const t=e.data().endTime;l=t?s().tz(`${o} ${t}`,"YYYY-MM-DD HH:mm","America/Los_Angeles"):a.add(1,"hour")}else a=s().tz(n,"America/Los_Angeles").startOf("day"),l=s().tz(o,"America/Los_Angeles").endOf("day");const r=a.tz(m),c=l.tz(m);if(!r.isValid()||!c.isValid())return void console.warn("Skipping invalid event:",{id:e.id,startRaw:n,endRaw:o,startTime:i});const d=e.id||e.data().title.toLowerCase().replace(/[^a-z0-9]/g,"-").replace(/-+/g,"-");t.push({id:d,title:e.data().title,start:r.toDate(),end:c.toDate(),allDay:!i,color:e.data().color,description:e.data().description,images:e.data().images,blogUrl:e.data().blogUrl,image:e.data().image,credits:e.data().credits,category:e.data().category||"special"})})),h=t,window.skyEventsManager?.setEventsData(t),function(e){const t=document.getElementById("calendar"),n=new FullCalendar.Calendar(t,{initialView:"dayGridMonth",fixedWeekCount:!1,aspectRatio:1.35,height:"auto",events:e,eventContent:function(e){const t=e.event.extendedProps.icon;return t?{html:`\n            <div class="event-icon-container">\n              <img src="${t}" class="event-icon" alt="event icon" />\n            </div>\n          `}:{html:`\n            <div class="event-content">\n              <span class="fc-event-title">${e.event.title}</span>\n            </div>\n          `}},eventOrder:"start",eventClick:function(e){S(e.event)},headerToolbar:{right:"prev,next today"}});n.render(),function(e,t){const n=document.createElement("select");n.id="category-filter",n.title="category-filter",n.innerHTML='\n        <option value="">All Categories</option>\n        <option value="special-event">Special Events</option>\n        <option value="shard">Shard</option>\n        <option value="days-of-events">Days of Events</option>\n        <option value="travelling-spirits">Travelling Spirits</option>\n        <option value="seasons">Seasons</option>\n        <option value="hide">Hide Shards</option>\n    ',document.querySelector(".fc-toolbar-chunk:nth-child(2)").appendChild(n),n.addEventListener("change",(function(){const n=this.value.toLowerCase(),o=t.filter((e=>"hide"===n?!e.category||!e.category.toLowerCase().includes("shard"):e.category&&e.category.toLowerCase()===n||""===n));e.removeAllEventSources(),e.addEventSource(o)}))}(n,e)}(t),function(e){const t=document.querySelector(".info-container");t.innerHTML="";const n=document.createElement("div");n.innerHTML="<h2>Heads Up!</h2>",t.appendChild(n);const o=new Date,i=[],a=[];if(e.forEach((e=>{const t=new Date(e.start),n=new Date(e.end),s=Math.ceil((t-o)/864e5),l=Math.ceil((n-o)/864e5);s>0&&s<=4&&(e.daysUntil=s,i.push(e)),o>=t&&l>0&&l<=4&&(e.daysUntil=l,a.push(e))})),i.sort(((e,t)=>e.daysUntil-t.daysUntil)),a.sort(((e,t)=>e.daysUntil-t.daysUntil)),i.length>0)i.slice(0,2).forEach((e=>{const n=y(e,"upcoming","https://img.icons8.com/?size=100&id=FhnRPWu7HD5f&format=png&color=000000","Coming Soon:",`begins in ${e.daysUntil} day${e.daysUntil>1?"s":""}!`);t.appendChild(n)}));else if(0===i.length&&0===a.length){const e=function(e){const t=document.createElement("div");return t.className=`event-notice ${e}`,t.innerHTML=`\n      <div class="notice-icon">\n        <img src="https://img.icons8.com/?size=100&id=3ovMFy5JDSWq&format=png&color=000000" alt="${e} event icon">\n      </div>\n      <div class="notice-text">\n        <p>Relax! No events are starting or ending within the next 4 days.</p>\n      </div>\n    `,t}("upcoming");t.appendChild(e)}if(a.length>0&&a.slice(0,2).forEach((e=>{const n=y(e,"ending","https://img.icons8.com/?size=100&id=Sd2tYsgMJNyn&format=png&color=000000","Last Chance:",`ends in ${e.daysUntil} day${e.daysUntil>1?"s":""}!`);t.appendChild(n)})),0===i.length&&0===a.length){const e=document.querySelector(".heads-up");e&&(e.style.display="none")}}(t),function(e){const t=document.getElementById("event-cards-container");if(!t)return void console.warn("Quick overview container not found");t.innerHTML="";const n=new Date,o=e.filter((e=>new Date(e.end)>=n)).slice(0,6);1===o.length?t.classList.add("single-card"):t.classList.remove("single-card"),0!==o.length?o.forEach(((e,n)=>{const o=function(e){const t=document.createElement("div");t.className="event-card",t.setAttribute("data-event-id",e.id);const n=new Date,o=new Date(e.start),i=new Date(e.end);let a="";a=n<o?"upcoming":n>=o&&n<=i?"ongoing":"past",t.classList.add(a),t.style.borderBottom=`4px solid ${e.color}`;const s=f(e.category),l=w(o,i),r=b(o,i,n);return e.title.includes("Traveling Spirit:")&&(e.title=e.title.replace("Traveling Spirit:","TS:")),e.title.includes("Traveling Spirits")&&(e.title=e.title.replace("Traveling Spirits","TS")),t.innerHTML=`\n    <div class="event-image-container">\n      ${e.image?`<img src="${e.image}" alt="${e.title}" class="event-image" onerror="this.parentElement.innerHTML='<div class=\\"event-image-placeholder\\">üåü</div>`:'<div class="event-image-placeholder">üåü</div>'}\n      <div class="event-badge ${s.class}">${s.text}</div>\n    </div>\n    <div class="event-content-overview">\n      <h3 class="event-title">${e.title.replace(/^[\p{Emoji}\p{Extended_Pictographic}]+\s*/u,"")}</h3>\n      <div class="event-date">${l}</div>\n      <div class="event-countdown ${r.class}">\n        <div class="countdown-label">${r.label}</div>\n        <div class="countdown-time">${r.time}</div>\n      </div>\n    </div>\n  `,t.addEventListener("click",(()=>{S(e)})),t}(e);o.style.animationDelay=.1*n+"s",t.appendChild(o)})):t.innerHTML='\n      <div class="empty-state">\n        <div class="empty-state-icon">üåü</div>\n        <div class="empty-state-text">No upcoming events</div>\n        <div class="empty-state-subtext">Check back soon for new Sky events!</div>\n      </div>\n    '}(t)})).catch((e=>{console.error("Error getting documents: ",e);const t=document.getElementById("eventsGrid");t&&(t.innerHTML='\n        <div class="empty-state" style="grid-column: 1 / -1; text-align: center; padding: 2rem;">\n          <div class="empty-state-icon" style="font-size: 3rem; margin-bottom: 1rem;">‚ö†Ô∏è</div>\n          <div class="empty-state-text" style="font-size: 1.25rem; font-weight: 600; margin-bottom: 0.5rem;">Failed to load events</div>\n          <div class="empty-state-subtext" style="color: var(--color-text-muted);">Please check your connection and try again.</div>\n        </div>\n      ')}));let L=setInterval((()=>{const e=document.querySelectorAll(".event-card-list");0!==e.length&&e.forEach((e=>{const t=e.getAttribute("data-event-id"),n=h.find((e=>e.id===t));if(n){const t=new Date,o=b(new Date(n.start),new Date(n.end),t),i=e.querySelector(".event-countdown"),a=e.querySelector(".countdown-label"),s=e.querySelector(".countdown-time");i&&a&&s&&(i.className=`event-countdown ${o.class}`,a.textContent=o.label,s.textContent=o.time)}}))}),6e4);window.addEventListener("beforeunload",(()=>{L&&clearInterval(L)}));let E=0,C=[];function S(e){const t=document.getElementById("eventModal"),n=document.getElementById("modalImageContainer"),o=document.getElementById("modalBadge"),i=document.getElementById("modalTitle"),a=document.getElementById("modalDescription"),s=document.getElementById("modalNote"),l=document.getElementById("modalShareBtn"),r=document.getElementById("modalCalendarBtn");!function(e,t){if(C=function(e){const t=[],n=e.extendedProps||{},o=M($(e.images??n.images??[]));for(const e of o)t.push({url:e,type:x(e),source:"gallery"});const i=M($(e.videos??n.videos??[]));for(const e of i)t.push({url:e,type:"video",source:"video"});const a=$(e.media??n.media??[]).map((e=>"string"==typeof e?{url:e}:e));for(const e of a){const n=e?.url;if(!n)continue;const o=e.type||x(n);t.some((e=>T(e.url)===T(n)))||t.push({url:n,type:o,source:"media"})}return t}(e),E=0,0===C.length)return void(t.innerHTML='<div class="modal-image-placeholder">üåü</div>');if(1===C.length){const n=C[0],o=k(n,e.title,!0);return void(t.innerHTML=`\n          ${o}\n          <div class="media-controls">\n            <button class="media-control-btn" onclick="downloadMedia('${n.url.replace(/'/g,"\\'")}')" title="Download">\n              üíæ\n            </button>\n            <button class="media-control-btn" onclick="openZoomModal('${n.url.replace(/'/g,"\\'")}', '${n.type}')" title="View Full Size">\n              üîç\n            </button>\n          </div>\n        `)}let n='\n        <div class="media-carousel">\n            <div class="media-slides" id="mediaSlides">\n    ';C.forEach(((t,o)=>{const i=k(t,e.title,0===o);n+=`<div class="media-slide">${i}</div>`})),n+='\n            </div>\n            <button class="carousel-nav prev" onclick="prevMedia()" id="prevBtn">‚Äπ</button>\n            <button class="carousel-nav next" onclick="nextMedia()" id="nextBtn">‚Ä∫</button>\n            <div class="media-controls">\n                <button class="media-control-btn" onclick="downloadCurrentMedia()" title="Download">\n                    üíæ\n                </button>\n                <button class="media-control-btn" onclick="openCurrentMediaZoom()" title="View Full Size">\n                    üîç\n                </button>\n            </div>\n            <div class="carousel-indicators" id="carouselIndicators">\n    ',C.forEach(((e,t)=>{n+=`<div class="carousel-indicator ${0===t?"active":""}" onclick="goToMedia(${t})"></div>`})),n+=`\n            </div>\n            <div class="media-counter">\n                <span id="mediaCounter">1 / ${C.length}</span>\n            </div>\n        </div>\n    `,t.innerHTML=n,B()}(e,n);const c=f(e.category||e.extendedProps&&e.extendedProps.category||"special");o.textContent=c.text,o.className=`modal-badge ${c.class}`;let d=e.title||"";d=d.replace("Traveling Spirit:","TS:"),d=d.replace("Traveling Spirits","TS"),d=d.replace(/^[\p{Emoji}\p{Extended_Pictographic}]+\s*/u,""),i.textContent=d,function(e){const t=document.getElementById("quickInfoSummary"),n=w(new Date(e.start),new Date(e.end||e.start)),o=e.extendedProps||{},i=e.category||o.category||"special";let a=[];if(a.push({icon:"üìÖ",label:"Date:",value:n}),"ts"===i){const t=o.realm||e.realm||null,n=o.location||e.location||null,i=o.memoryType||e.memoryType||null,s=o.emote||e.emote||null;a.push({icon:"üåç",label:"Realm:",value:t||"To be announced"},{icon:"üìå",label:"Location:",value:n||"To be announced"},{icon:"üé≠",label:"Memory Type:",value:i||"N/A"},{icon:"üïäÔ∏è",label:"Emote:",value:s||"N/A"})}else if("season"===i){const t=o.seasonType||e.seasonType||null,n=o.spiritCount||e.spiritCount||null,i=o.duration||e.duration||null,s=o.specialItems||e.specialItems||null;a.push({icon:"üé≠",label:"Season Type:",value:t||"To be announced"},{icon:"üë•",label:"Spirits:",value:n||"To be announced"},{icon:"‚è±Ô∏è",label:"Duration:",value:i||"To be announced"},{icon:"‚ú®",label:"Special Items:",value:s||"To be announced"})}else if("special"===i){const t=o.eventType||e.eventType||null,n=o.activities||e.activities||null,i=o.rewards||e.rewards||null,s=o.requirements||e.requirements||null;a.push({icon:"üéâ",label:"Event Type:",value:t||"Special Event"},{icon:"üéØ",label:"Activities:",value:n||"To be announced"},{icon:"üéÅ",label:"Rewards:",value:i||"To be announced"},{icon:"üìã",label:"Requirements:",value:s||"None specified"})}else if("group_ts"===i||e.title.toLowerCase().includes("traveling spirits")){const t=o.spiritCount||e.spiritCount||null,n=o.realms||e.realms||null,i=o.duration||e.duration||null,s=o.returnType||e.returnType||null;a.push({icon:"üë•",label:"Spirit Count:",value:t||"To be announced"},{icon:"üåç",label:"Realms:",value:n||"Multiple realms"},{icon:"‚è±Ô∏è",label:"Duration:",value:i||"To be announced"},{icon:"üîÑ",label:"Return Type:",value:s||"Regular return"})}else{const t=o.eventType||e.eventType||null,n=o.location||e.location||null;a.push({icon:"üéØ",label:"Event Type:",value:t||"General Event"},{icon:"üìå",label:"Location:",value:n||"To be announced"})}let s='<div class="quick-info-title">Quick Info Summary</div>';a.forEach((e=>{const t=e.value&&"N/A"!==e.value&&"To be announced"!==e.value&&"None specified"!==e.value?"info-value":"info-value na";s+=`\n            <div class="info-item">\n                <span class="info-icon">${e.icon}</span>\n                <span class="info-label">${e.label}</span>\n                <span class="${t}">${e.value}</span>\n            </div>\n        `})),t.innerHTML=s}(e);const u=e.description||e.extendedProps&&e.extendedProps.description;u&&u.trim()?a.innerHTML=`\n            <div class="description-title">Description</div>\n            <div class="description-content">${u}</div>\n        `:a.innerHTML='\n            <div class="description-title">Description</div>\n            <div class="description-content na">Information will be updated as it becomes available.</div>\n        ';const v=e.note||e.extendedProps&&e.extendedProps.note;v&&v.trim()?(s.innerHTML=`\n            <div class="note-title">Note</div>\n            <div class="note-content">${v}</div>\n        `,s.style.display="block"):(s.innerHTML='\n            <div class="note-title">Reminder</div>\n            <div class="note-content">Event details are subject to change. Please check back for updates.</div>\n        ',s.style.display="block"),l.onclick=()=>function(e){const t={title:e.title,text:`Check out this Sky: Children of the Light event: ${e.title}`,url:window.location.href};navigator.share&&navigator.canShare&&navigator.canShare(t)?navigator.share(t).catch((()=>{F(e)})):F(e)}(e),r.onclick=()=>function(e){const t=new Date(e.start),n=new Date(e.end||e.start),o=e=>e.toISOString().replace(/[-:]/g,"").replace(/\.\d{3}/,""),i=o(t),a=o(n);let s=e.title.replace("Traveling Spirit:","TS:");s=s.replace("Traveling Spirits","TS"),s=s.replace(/^[\p{Emoji}\p{Extended_Pictographic}]+\s*/u,"");const l=e.extendedProps||{};let r="Sky: Children of the Light Event\n\n";(l.realm||e.realm)&&(r+=`Realm: ${l.realm||e.realm}\n`),(l.location||e.location)&&(r+=`Location: ${l.location||e.location}\n`),(l.memoryType||e.memoryType)&&(r+=`Memory Type: ${l.memoryType||e.memoryType}\n`),(l.emote||e.emote)&&(r+=`Emote: ${l.emote||e.emote}\n`),(e.description||l.description)&&(r+=`\nDescription:\n${e.description||l.description}`);const c=`https://calendar.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(s)}&dates=${i}/${a}&details=${encodeURIComponent(r)}&location=${encodeURIComponent("Sky: Children of the Light")}`;window.open(c,"_blank")}(e),t.classList.add("active"),document.body.style.overflow="hidden"}function $(e){if(!e)return[];if(Array.isArray(e))return e;if("string"==typeof e){const t=e.trim();if(!t)return[];if(t.startsWith("[")&&t.endsWith("]")||t.startsWith('"')&&t.endsWith('"'))try{const e=JSON.parse(t);return Array.isArray(e)?e:[t]}catch(e){}return t.split(/[,|\n]/).map((e=>e.trim())).filter(Boolean)}return"object"==typeof e&&e.url?[e.url]:[]}function T(e){try{const t=new URL(e,window.location.href);return`${t.origin}${t.pathname}`}catch{return(e||"").split("?")[0]}}function M(e){const t=[],n=new Set;for(const o of e){const e="string"==typeof o?o:o?.url;if(!e)continue;const i=T(e);n.has(i)||(n.add(i),t.push(e))}return t}function x(e){const t=e.toLowerCase();return[".mp4",".webm",".ogg",".mov",".avi",".m4v",".3gp"].some((e=>t.includes(e)))?"video":t.includes(".gif")||t.includes(".webp")?"animated-image":"image"}function k(e,t,n=!1){const{url:o,type:i}=e,a=o.replace(/'/g,"&#39;").replace(/"/g,"&quot;");switch(i){case"video":return`\n                <video class="modal-video" ${n?"controls autoplay muted loop":"controls muted"}>\n                    <source src="${a}" type="${H(o)}">\n                    Your browser does not support the video tag.\n                </video>\n            `;case"animated-image":return`\n                <img src="${a}" alt="${t}" class="modal-image animated-image"\n                     onclick="openZoomModal('${a}', '${i}')"\n                     onerror="this.parentElement.innerHTML='<div class=&quot;media-error&quot;>Failed to load media</div>'">\n            `;default:return`\n                <img src="${a}" alt="${t}" class="modal-image"\n                     onclick="openZoomModal('${a}', '${i}')"\n                     onerror="this.parentElement.innerHTML='<div class=&quot;media-error&quot;>Failed to load image</div>'">\n            `}}function D(){E>0&&(E--,P())}function I(){E<C.length-1&&(E++,P())}function P(){const e=document.getElementById("mediaSlides");if(!e)return;e.style.transform=`translateX(-${100*E}%)`,document.querySelectorAll(".carousel-indicator").forEach(((e,t)=>{e.classList.toggle("active",t===E)}));const t=document.getElementById("mediaCounter");t&&(t.textContent=`${E+1} / ${C.length}`),function(){document.querySelectorAll(".modal-video").forEach((e=>{e.pause()}));const e=document.querySelectorAll(".media-slide")[E];if(e){const t=e.querySelector(".modal-video");t&&t.play().catch((()=>{}))}}(),B()}function B(){const e=document.getElementById("prevBtn"),t=document.getElementById("nextBtn");e&&(e.disabled=0===E,e.style.opacity=0===E?"0.5":"1"),t&&(t.disabled=E===C.length-1,t.style.opacity=E===C.length-1?"0.5":"1")}function H(e){const t=e.toLowerCase();return t.includes(".mp4")?"video/mp4":t.includes(".webm")?"video/webm":t.includes(".ogg")?"video/ogg":t.includes(".mov")?"video/quicktime":t.includes(".avi")?"video/x-msvideo":"video/mp4"}function q(e){let t=e;if(e.includes("imagekit.io")){const n=e.includes("?")?"&":"?";t=`${e}${n}ik-attachment=true`}const n=document.createElement("a");n.href=t,n.download=function(e){try{return new URL(e).pathname.split("/").pop()||`sky-media-${Date.now()}`}catch(e){return`sky-media-${Date.now()}`}}(e),n.target="_blank",n.rel="noopener noreferrer",document.body.appendChild(n),n.click(),document.body.removeChild(n)}function N(e,t=null){let n=document.getElementById("zoomModal");n||(n=document.createElement("div"),n.id="zoomModal",n.className="zoom-modal",document.body.appendChild(n));const o=t||x(e),i=e.replace(/'/g,"&#39;").replace(/"/g,"&quot;");let a;switch(o){case"video":a=`\n                <div class="zoom-content">\n                    <video class="zoom-video" controls autoplay muted loop>\n                        <source src="${i}" type="${H(e)}">\n                        Your browser does not support the video tag.\n                    </video>\n                    <div class="zoom-controls">\n                        <button class="zoom-btn" onclick="downloadMedia('${i}')" title="Download">\n                            üíæ\n                        </button>\n                        <button class="zoom-btn" onclick="closeZoomModal()" title="Close">\n                            ‚úï\n                        </button>\n                    </div>\n                </div>\n            `;break;case"animated-image":a=`\n                <div class="zoom-content">\n                    <img src="${i}" alt="Zoomed animated image" class="zoom-image">\n                    <div class="zoom-controls">\n                        <button class="zoom-btn" onclick="downloadMedia('${i}')" title="Download">\n                            üíæ\n                        </button>\n                        <button class="zoom-btn" onclick="closeZoomModal()" title="Close">\n                            ‚úï\n                        </button>\n                    </div>\n                </div>\n            `;break;default:a=`\n                <div class="zoom-content">\n                    <img src="${i}" alt="Zoomed media" class="zoom-image">\n                    <div class="zoom-controls">\n                        <button class="zoom-btn" onclick="downloadMedia('${i}')" title="Download">\n                            üíæ\n                        </button>\n                        <button class="zoom-btn" onclick="closeZoomModal()" title="Close">\n                            ‚úï\n                        </button>\n                    </div>\n                </div>\n            `}n.innerHTML=a,n.classList.add("active"),document.body.style.overflow="hidden",n.onclick=e=>{e.target===n&&z()}}function z(){const e=document.getElementById("zoomModal");if(e){const t=e.querySelector(".zoom-video");t&&t.pause(),e.classList.remove("active"),document.getElementById("eventModal").classList.contains("active")||(document.body.style.overflow="")}}function A(){const e=document.getElementById("eventModal");e.classList.remove("active"),document.body.style.overflow="",e.querySelectorAll(".modal-video").forEach((e=>{e.pause()}))}function F(e){const t=`${e.title}\n${w(new Date(e.start),new Date(e.end||e.start))}\n${window.location.href}`;navigator.clipboard?navigator.clipboard.writeText(t).then((()=>{U("Event details copied to clipboard!")})).catch((()=>{O(t)})):O(t)}function O(e){const t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.left="-999999px",t.style.top="-999999px",document.body.appendChild(t),t.focus(),t.select();try{document.execCommand("copy"),U("Event details copied to clipboard!")}catch(e){U("Unable to copy to clipboard")}finally{document.body.removeChild(t)}}function U(e){const t=document.createElement("div");t.style.cssText="\n        position: fixed;\n        top: 20px;\n        right: 20px;\n        background: #333;\n        color: white;\n        padding: 12px 16px;\n        border-radius: 8px;\n        z-index: 10000;\n        font-size: 0.9rem;\n        box-shadow: 0 4px 12px rgba(0,0,0,0.3);\n        transition: opacity 0.3s ease;\n    ",t.textContent=e,document.body.appendChild(t),setTimeout((()=>{t.style.opacity="0",setTimeout((()=>{t.parentNode&&document.body.removeChild(t)}),300)}),3e3)}document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("closeModal");e&&e.addEventListener("click",A);const t=document.getElementById("eventModal");t&&t.addEventListener("click",(e=>{e.target.classList.contains("modal-overlay")&&A()})),document.addEventListener("keydown",(e=>{if("Escape"===e.key){const e=document.getElementById("eventModal"),t=document.getElementById("zoomModal");t&&t.classList.contains("active")?z():e&&e.classList.contains("active")&&A()}})),document.addEventListener("keydown",(e=>{const t=document.getElementById("eventModal");t&&t.classList.contains("active")&&("ArrowLeft"===e.key?(e.preventDefault(),D()):"ArrowRight"===e.key&&(e.preventDefault(),I()))}))})),window.openEventModal=S,window.closeEventModal=A,window.downloadMedia=q,window.openZoomModal=N,window.nextMedia=I,window.prevMedia=D,window.goToMedia=function(e){e>=0&&e<C.length&&(E=e,P())},window.downloadCurrentMedia=function(){C[E]&&q(C[E].url)},window.openCurrentMediaZoom=function(){if(C[E]){const e=C[E];N(e.url,e.type)}},window.closeZoomModal=z;class Z{constructor(){this.events=[],this.allEvents=[],this.favorites=JSON.parse(localStorage.getItem("skyEventsFavorites")||"[]"),this.currentFilter="all",this.searchTerm="",this.countdownIntervals=new Map,this.calendar=null,this.currentPage=1,this.eventsPerPage=6,this.filteredEvents=[],this.init()}init(){this.setupEventListeners(),this.initializeFilters(),this.createPaginationContainer()}setEventsData(e){this.allEvents=e,this.events=this.convertFirebaseEventsToCardFormat(e),this.filterEvents(),this.renderCurrentPage()}convertFirebaseEventsToCardFormat(e){return e.map((e=>({id:e.id,title:e.title,description:e.description||"",category:e.category||"special",start:e.start,end:e.end,allDay:e.allDay,color:e.color,image:e.image,images:e.images,blogUrl:e.blogUrl,credits:e.credits}))).sort(((e,t)=>{const n=new Date(e.start);return new Date(t.start)-n}))}filterEvents(){this.filteredEvents=this.events.filter((e=>{const t="all"===this.currentFilter||this.currentFilter===e.category||"favorites"===this.currentFilter&&this.favorites.includes(e.id),n=this.searchTerm.toLowerCase(),o=""===this.searchTerm||e.title.toLowerCase().includes(n);return t&&o})),this.currentPage=1}getCurrentPageEvents(){const e=(this.currentPage-1)*this.eventsPerPage,t=e+this.eventsPerPage;return this.filteredEvents.slice(e,t)}getTotalPages(){return Math.ceil(this.filteredEvents.length/this.eventsPerPage)}renderCurrentPage(){const e=document.getElementById("eventsGrid");if(!e)return;e.innerHTML="";const t=this.getCurrentPageEvents();if(0===t.length)return this.showEmptyState(),void this.updatePagination();t.forEach((t=>{const n=this.createEventCard(t);e.appendChild(n)})),this.updateFavoriteButtons(),this.updatePagination(),setTimeout((()=>{this.startCountdowns()}),50)}createEventCard(e){const t=document.createElement("div");t.className=`event-list-card ${e.category}`,t.dataset.eventId=e.id,t.dataset.category=e.category;const n=new Date,o=new Date(e.start),i=new Date(e.end),a=n>=o&&n<=i,s=n<o,l=n>i,r=this.getCategoryBadge(e.category),c=this.getCategoryIcon(e.category),d=this.generateCountdownHtml(e,a,s,l);return t.innerHTML=`\n      <div class="event-list-badge">\n        <span class="event-list-badge-item ${e.category}-badge">${r}</span>\n      </div>\n      \n      <div class="event-list-header">\n        <div class="event-list-icon">\n          ${c}\n        </div>\n        <h3 class="event-list-title">${e.title}</h3>\n      </div>\n      \n      <div class="event-list-info">\n        ${e.description?`<div class="event-list-description" hidden>${e.description}</div>`:""}\n        \n        <div class="event-list-details">\n          <div class="event-list-detail-item">\n            <span class="event-list-detail-label">Start:</span>\n            <span class="event-list-detail-value">${this.formatDate(o)}</span>\n          </div>\n          <div class="event-list-detail-item">\n            <span class="event-list-detail-label">End:</span>\n            <span class="event-list-detail-value">${this.formatDate(i)}</span>\n          </div>\n          ${"season"===e.category?'\n          <div class="event-list-detail-item">\n            <span class="event-list-detail-label">Type:</span>\n            <span class="event-list-detail-value">Seasonal Event</span>\n          </div>\n          ':""}\n        </div>\n      </div>\n      \n      ${d}\n      \n      <div class="event-list-actions">\n        <button class="event-list-btn event-list-btn-primary" onclick="openEventModal(${JSON.stringify(e).replace(/"/g,"&quot;")})">\n          View Details\n        </button>\n        <button class="event-list-btn event-list-btn-secondary event-list-favorite-btn" data-event-id="${e.id}">\n          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>\n          </svg>\n        </button>\n      </div>\n    `,t}getCategoryBadge(e){const t={seasons:"Season","travelling-spirits":"Traveling Spirit","special-event":"Special Event",shards:"Shard Event","days-of-events":"Days of Event",default:"Event"};return t[e]||t.default}getCategoryIcon(e){const t={seasons:'<svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">\n        <path d="M12 2L15.5 8.5L22 12L15.5 15.5L12 22L8.5 15.5L2 12L8.5 8.5L12 2Z"/>\n      </svg>',"travelling-spirits":'<svg width="24" height="24" viewBox="0 0 48 48" fill="currentColor" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">\n          <path d="M24 4L29 14L44 24L29 34L24 44L19 34L4 24L19 14L24 4Z"/>\n          <path d="M12 6L14 10L18 12L14 14L12 18L10 14L6 12L10 10L12 6Z"/>\n          <path d="M36 30L38 34L42 36L38 38L36 42L34 38L30 36L34 34L36 30Z"/>\n        </svg>',"special-event":'<svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">\n            <rect x="9" y="10" width="6" height="12" rx="1"/>\n            <path d="M12 2C13.2 4 14 5.5 14 7C14 8.66 13 10 12 10C11 10 10 8.66 10 7C10 5.5 10.8 4 12 2Z"/>\n          </svg>',shards:'<svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">\n        <path d="M12 2L15.5 8.5L22 12L15.5 15.5L12 22L8.5 15.5L2 12L8.5 8.5L12 2Z"/>\n      </svg>',"days-of-events":'<svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">\n        <path d="M19 3H18V1H16V3H8V1H6V3H5C3.89 3 3.01 3.9 3.01 5L3 19C3 20.1 3.89 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM19 19H5V8H19V19Z"/>\n      </svg>',default:'<svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">\n        <path d="M12 2L15.5 8.5L22 12L15.5 15.5L12 22L8.5 15.5L2 12L8.5 8.5L12 2Z"/>\n      </svg>'};return t[e]||t.default}generateCountdownHtml(e,t,n,o){return o?'\n        <div class="event-list-countdown event-list-countdown-ended">\n          <div class="event-list-countdown-item">\n            <span class="event-list-countdown-number">Event</span>\n            <span class="event-list-countdown-label">Ended</span>\n          </div>\n        </div>\n      ':`\n      <div class="event-list-countdown ${t?"event-list-countdown-active":"event-list-countdown-upcoming"}" data-target-date="${t?e.end:e.start}">\n        <div class="event-list-countdown-item">\n          <span class="event-list-countdown-number">--</span>\n          <span class="event-list-countdown-label">Days</span>\n        </div>\n        <div class="event-list-countdown-item">\n          <span class="event-list-countdown-number">--</span>\n          <span class="event-list-countdown-label">Hours</span>\n        </div>\n        <div class="event-list-countdown-item">\n          <span class="event-list-countdown-number">--</span>\n          <span class="event-list-countdown-label">Min</span>\n        </div>\n      </div>\n    `}formatDate(e){return e.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:0!==e.getHours()?"numeric":void 0,minute:0!==e.getHours()?"2-digit":void 0})}setupEventListeners(){document.addEventListener("input",(e=>{("eventListSearch"===e.target.id||e.target.classList.contains("event-list-search-input"))&&(this.searchTerm=e.target.value.toLowerCase(),this.filterEvents(),this.renderCurrentPage())})),document.addEventListener("click",(e=>{if(e.target.classList.contains("event-list-filter-btn")&&this.handleFilterClick(e.target),e.target.closest(".event-list-favorite-btn")&&this.handleFavoriteClick(e.target.closest(".event-list-favorite-btn")),e.target.classList.contains("pagination-btn")){const t=parseInt(e.target.dataset.page);t&&t!==this.currentPage&&(this.currentPage=t,this.renderCurrentPage(),setTimeout((()=>{this.startCountdowns()}),100))}e.target.classList.contains("pagination-prev")&&this.currentPage>1&&(this.currentPage--,this.renderCurrentPage(),setTimeout((()=>{this.startCountdowns()}),100)),e.target.classList.contains("pagination-next")&&this.currentPage<this.getTotalPages()&&(this.currentPage++,this.renderCurrentPage(),setTimeout((()=>{this.startCountdowns()}),100))}));const e=document.querySelector(".event-list-theme-toggle");e&&e.addEventListener("click",this.toggleTheme)}handleFilterClick(e){document.querySelectorAll(".event-list-filter-btn").forEach((e=>e.classList.remove("active"))),e.classList.add("active"),this.currentFilter=e.dataset.filter,this.filterEvents(),this.renderCurrentPage(),setTimeout((()=>{this.startCountdowns()}),100)}handleFavoriteClick(e){const t=e.dataset.eventId,n=this.favorites.indexOf(t);n>-1?(this.favorites.splice(n,1),e.classList.remove("favorited")):(this.favorites.push(t),e.classList.add("favorited")),localStorage.setItem("skyEventsFavorites",JSON.stringify(this.favorites)),this.updateFavoriteButton(e,t)}updateFavoriteButton(e,t){const n=this.favorites.includes(t);e.classList.toggle("favorited",n),e.style.transform="scale(1.2)",setTimeout((()=>{e.style.transform=""}),150)}showEmptyState(){const e=document.getElementById("eventsGrid");if(!e)return;let t='\n      <div class="event-list-empty-message">\n        <div class="empty-state">\n    ';this.searchTerm?t+='\n        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n          <circle cx="11" cy="11" r="8"/>\n          <path d="m21 21-4.35-4.35"/>\n        </svg>\n        <h3>No events found</h3>\n        <p>Try adjusting your search terms or filters</p>\n      ':"favorites"===this.currentFilter?t+='\n        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n          <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>\n        </svg>\n        <h3>No favorite events</h3>\n        <p>Start adding events to your favorites by clicking the heart icon</p>\n      ':t+='\n        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n          <path d="M12,2L13.5,7.5L19,9L13.5,10.5L12,16L10.5,10.5L5,9L10.5,7.5L12,2Z"/>\n        </svg>\n        <h3>No events in this category</h3>\n        <p>Try selecting a different filter</p>\n      ',t+="\n        </div>\n      </div>\n    ",e.innerHTML=t}updateFavoriteButtons(){document.querySelectorAll(".event-list-favorite-btn").forEach((e=>{const t=e.dataset.eventId;this.favorites.includes(t)&&e.classList.add("favorited")}))}createPaginationContainer(){let e=document.querySelector(".event-list-pagination");if(!e){e=document.createElement("div"),e.className="event-list-pagination";const t=document.getElementById("eventsGrid");t&&t.parentNode&&t.parentNode.insertBefore(e,t.nextSibling)}}updatePagination(){const e=document.querySelector(".event-list-pagination");if(!e)return;const t=this.getTotalPages();if(t<=1)return void(e.innerHTML="");let n=`\n      <div class="pagination-info">\n        Showing ${(this.currentPage-1)*this.eventsPerPage+1}-${Math.min(this.currentPage*this.eventsPerPage,this.filteredEvents.length)} of ${this.filteredEvents.length} events\n      </div>\n      <div class="pagination-controls">\n        <button class="pagination-btn pagination-prev" ${1===this.currentPage?"disabled":""}>\n          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n            <polyline points="15,18 9,12 15,6"></polyline>\n          </svg>\n          Previous\n        </button>\n    `,o=Math.max(1,this.currentPage-Math.floor(2.5)),i=Math.min(t,o+5-1);i-o<4&&(o=Math.max(1,i-5+1)),o>1&&(n+='<button class="pagination-btn" data-page="1">1</button>',o>2&&(n+='<span class="pagination-ellipsis">...</span>'));for(let e=o;e<=i;e++)n+=`\n        <button class="pagination-btn ${e===this.currentPage?"active":""}" data-page="${e}">\n          ${e}\n        </button>\n      `;i<t&&(i<t-1&&(n+='<span class="pagination-ellipsis">...</span>'),n+=`<button class="pagination-btn" data-page="${t}">${t}</button>`),n+=`\n        <button class="pagination-btn pagination-next" ${this.currentPage===t?"disabled":""}>\n          Next\n          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n            <polyline points="9,18 15,12 9,6"></polyline>\n          </svg>\n        </button>\n      </div>\n    `,e.innerHTML=n}initializeFilters(){let e=document.querySelector(".event-list-filters");if(!e){e=document.createElement("div"),e.className="event-list-filters";const t=document.getElementById("eventsGrid");t&&t.parentNode.insertBefore(e,t)}e.innerHTML=[{key:"all",label:"All Events"},{key:"seasons",label:"Seasons"},{key:"travelling-spirits",label:"Traveling Spirits"},{key:"special-event",label:"Special Events"},{key:"days-of-events",label:"Days of Events"},{key:"shards",label:"Shard Events"},{key:"favorites",label:"Favorites"}].map((e=>`<button class="event-list-filter-btn ${"all"===e.key?"active":""}" data-filter="${e.key}">\n        ${e.label}\n      </button>`)).join("")}startCountdowns(){this.countdownIntervals.forEach((e=>clearInterval(e))),this.countdownIntervals.clear(),document.querySelectorAll(".event-list-countdown").forEach((e=>{if(e.classList.contains("event-list-countdown-ended"))return;const t=e.closest(".event-list-card");if(!t)return;const n=t.dataset.eventId,o=e.dataset.targetDate;if(o&&n){const t=setInterval((()=>{this.updateCountdown(e,o)}),1e3);this.countdownIntervals.set(n,t),this.updateCountdown(e,o)}}))}updateCountdown(e,t){const n=(new Date).getTime(),o=new Date(t).getTime()-n;if(o<0)return e.innerHTML='\n        <div class="event-list-countdown-item">\n          <span class="event-list-countdown-number">Event</span>\n          <span class="event-list-countdown-label">Ended</span>\n        </div>\n      ',void(e.className="event-list-countdown event-list-countdown-ended");const i=Math.floor(o/864e5),a=Math.floor(o%864e5/36e5),s=Math.floor(o%36e5/6e4),l=Math.floor(o%6e4/1e3),r=e.querySelectorAll(".event-list-countdown-item");i>0?(r[0]&&(r[0].querySelector(".event-list-countdown-number").textContent=i,r[0].querySelector(".event-list-countdown-label").textContent="Days"),r[1]&&(r[1].querySelector(".event-list-countdown-number").textContent=a,r[1].querySelector(".event-list-countdown-label").textContent="Hours"),r[2]&&(r[2].querySelector(".event-list-countdown-number").textContent=s,r[2].querySelector(".event-list-countdown-label").textContent="Min")):(r[0]&&(r[0].querySelector(".event-list-countdown-number").textContent=a,r[0].querySelector(".event-list-countdown-label").textContent="Hours"),r[1]&&(r[1].querySelector(".event-list-countdown-number").textContent=s,r[1].querySelector(".event-list-countdown-label").textContent="Min"),r[2]&&(r[2].querySelector(".event-list-countdown-number").textContent=l,r[2].querySelector(".event-list-countdown-label").textContent="Sec"))}toggleTheme(){const e="dark"===document.documentElement.getAttribute("data-theme")?"light":"dark";document.documentElement.setAttribute("data-theme",e),localStorage.setItem("skyEventsTheme",e)}setupNotifications(){"Notification"in window&&Notification.requestPermission()}scheduleEventNotification(e,t=30){const n=new Date(e.startDate||e.nextOccurrence),o=new Date(n.getTime()-60*t*1e3),i=new Date;if(o>i){const n=o.getTime()-i.getTime();setTimeout((()=>{"granted"===Notification.permission&&new Notification("Sky COTL Event Reminder",{body:`${e.title} starts in ${t} minutes!`,icon:"/favicon.ico",badge:"/favicon.ico"})}),n)}}destroy(){this.countdownIntervals.forEach((e=>clearInterval(e))),this.countdownIntervals.clear(),this.calendar&&this.calendar.destroy()}}document.addEventListener("DOMContentLoaded",(()=>{const e=localStorage.getItem("skyEventsTheme")||"light";document.documentElement.setAttribute("data-theme",e),window.skyEventsManager=new Z,setTimeout((()=>{if(!document.getElementById("eventListSearch")){const e=document.createElement("div");e.className="event-list-search-container",e.innerHTML='\n        <input \n          type="text" \n          id="eventListSearch" \n          class="event-list-search-input" \n          placeholder="Search events..." \n          aria-label="Search events"\n        >\n      ';const t=document.getElementById("eventsGrid");t&&t.parentNode.insertBefore(e,t)}}),100)})),e.exports&&(e.exports=Z)}},n={};function o(e){var i=n[e];if(void 0!==i)return i.exports;var a=n[e]={id:e,loaded:!1,exports:{}};return t[e].call(a.exports,a,a.exports,o),a.loaded=!0,a.exports}o.m=t,e=[],o.O=(t,n,i,a)=>{if(!n){var s=1/0;for(d=0;d<e.length;d++){for(var[n,i,a]=e[d],l=!0,r=0;r<n.length;r++)(!1&a||s>=a)&&Object.keys(o.O).every((e=>o.O[e](n[r])))?n.splice(r--,1):(l=!1,a<s&&(s=a));if(l){e.splice(d--,1);var c=i();void 0!==c&&(t=c)}}return t}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[n,i,a]},o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={57:0};o.O.j=t=>0===e[t];var t=(t,n)=>{var i,a,[s,l,r]=n,c=0;if(s.some((t=>0!==e[t]))){for(i in l)o.o(l,i)&&(o.m[i]=l[i]);if(r)var d=r(o)}for(t&&t(n);c<s.length;c++)a=s[c],o.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return o.O(d)},n=self.webpackChunkthat_sky_calendar=self.webpackChunkthat_sky_calendar||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var i=o.O(void 0,[424,252,96],(()=>o(44)));i=o.O(i)})();