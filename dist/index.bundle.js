(()=>{"use strict";var e,t={44:(e,t,n)=>{var o=n(223),i=n(405),s=n(353),a=n.n(s),r=n(826),l=n.n(r),c=n(569),d=n.n(c),u=n(445),v=n.n(u);e=n.hmd(e),a().extend(l()),a().extend(d()),a().extend(v());const h=a().tz.guess();(0,o.Wp)({apiKey:"AIzaSyDChyRMRZw13CIheI4_vd5bsrFLBprMC20",authDomain:"that-sky-calendar-ffd49.firebaseapp.com",projectId:"that-sky-calendar-ffd49",storageBucket:"that-sky-calendar-ffd49.appspot.com",messagingSenderId:"994867085966",appId:"1:994867085966:web:ea6d5b05bccb508eb73fdf",measurementId:"G-FXXSH6NS6Z"});const m=(0,i.aU)(),p=(0,i.rJ)(m,"events");let g,y=[];class f{constructor(){this.cache=new Map,this.cacheExpiry=new Map,this.defaultTTL=3e5}set(e,t,n=this.defaultTTL){this.cache.set(e,t),this.cacheExpiry.set(e,Date.now()+n)}get(e){if(this.cache.has(e)){const t=this.cacheExpiry.get(e);if(Date.now()<t)return this.cache.get(e);this.cache.delete(e),this.cacheExpiry.delete(e)}return null}clear(){this.cache.clear(),this.cacheExpiry.clear()}}class w{constructor(e){this.db=e,this.isExpanded=!1,this.isVisible=!1,this.elements={},this.pollInterval=null,this.cacheManager=new f,this.checkInterval=12e4,this.init()}init(){this.elements={sticker:document.getElementById("noteSticker"),content:document.getElementById("noteContent"),message:document.getElementById("noteMessage"),typeIcon:document.getElementById("noteTypeIcon"),typeText:document.getElementById("noteTypeText"),timestamp:document.getElementById("noteTimestamp")},this.setupEventListeners(),this.startListening()}setupEventListeners(){document.addEventListener("click",(e=>{this.isExpanded&&this.elements.sticker&&!this.elements.sticker.contains(e.target)&&this.collapse()})),document.addEventListener("keydown",(e=>{"Escape"===e.key&&this.isExpanded&&this.collapse()}));const e=document.getElementById("prevNote"),t=document.getElementById("nextNote");e&&e.addEventListener("click",(()=>this.showPrevNote())),t&&t.addEventListener("click",(()=>this.showNextNote()))}showPrevNote(){this.notes&&0!==this.notes.length&&(this.currentNoteIndex=(this.currentNoteIndex-1+this.notes.length)%this.notes.length,this.displayNote(this.notes[this.currentNoteIndex]))}showNextNote(){this.notes&&0!==this.notes.length&&(this.currentNoteIndex=(this.currentNoteIndex+1)%this.notes.length,this.displayNote(this.notes[this.currentNoteIndex]))}startListening(){const e=(0,i.rJ)(this.db,"updateNotes");this.unsubscribe=(0,i.aQ)(e,(e=>{const t=[];e.forEach((e=>{if(e.exists()){const n=e.data();this.shouldShowNote(n)&&t.push({id:e.id,...n})}})),t.length>0?this.handleMultipleNotes(t):this.hide()}),(e=>{console.error("Error listening to notes:",e)}))}handleMultipleNotes(e){this.notes=e,this.currentNoteIndex=0,this.displayNote(this.notes[this.currentNoteIndex])}async checkForNotes(){const e="note_data",t=this.cacheManager.get(e);if(t)this.handleNoteData(t);else try{const t=(0,i.H9)(this.db,"updateNotes","note#1"),n=await(0,i.x7)(t);if(n.exists()){const t=n.data();this.cacheManager.set(e,t,6e4),this.handleNoteData(t)}else this.hide()}catch(e){console.error("Error fetching note:",e)}}handleNoteData(e){this.shouldShowNote(e)?this.displayNote(e):this.hide()}shouldShowNote(e){return!!e.isActive&&!(e.expiresAt&&new Date>(e.expiresAt.toDate?e.expiresAt.toDate():new Date(e.expiresAt)))}displayNote(e){const t=this.getTypeInfo(e.type);this.elements.typeIcon&&(this.elements.typeIcon.textContent=t.icon),this.elements.typeText&&(this.elements.typeText.textContent=t.title),this.elements.message&&(this.elements.message.textContent=e.message||""),this.elements.timestamp&&(this.elements.timestamp.textContent=this.formatTimestamp(e.createdAt)),this.updateTriggerStyle(t.color,e.priority),this.show()}show(){this.elements.sticker&&(this.elements.sticker.style.display="block",this.isVisible=!0,requestAnimationFrame((()=>{this.elements.sticker.style.opacity="0",this.elements.sticker.style.transform="translateY(20px) scale(0.8)",setTimeout((()=>{this.elements.sticker.style.transition="all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55)",this.elements.sticker.style.opacity="1",this.elements.sticker.style.transform="translateY(0) scale(1)"}),50)})))}hide(){this.isVisible&&this.elements.sticker&&(this.collapse(),setTimeout((()=>{this.elements.sticker.style.transition="all 0.3s ease-out",this.elements.sticker.style.opacity="0",this.elements.sticker.style.transform="translateY(20px) scale(0.8)",setTimeout((()=>{this.elements.sticker.style.display="none",this.isVisible=!1}),300)}),100))}toggle(){this.isExpanded?this.collapse():this.expand()}expand(){this.isVisible&&this.elements.content&&(this.isExpanded=!0,this.elements.content.classList.add("show"))}collapse(){this.isExpanded=!1,this.elements.content&&this.elements.content.classList.remove("show")}getTypeInfo(e){const t={update:{icon:"‚ú®",title:"Update",color:"#ff6b6b"},correction:{icon:"üìù",title:"Correction",color:"#f39c12"},delay:{icon:"‚è∞",title:"Notice",color:"#3498db"},personal:{icon:"üíô",title:"Personal Note",color:"#9b59b6"},celebration:{icon:"üéâ",title:"Celebration",color:"#2ecc71"},alert:{icon:"‚ö†Ô∏è",title:"Alert",color:"#e74c3c"},info:{icon:"‚ÑπÔ∏è",title:"Info",color:"#17a2b8"}};return t[e]||t.update}updateTriggerStyle(e,t="normal"){if(!this.elements.sticker)return;const n=this.elements.sticker.querySelector(".note-trigger");if(!n)return;let o=e;"high"===t?o=this.brightenColor(e,20):"low"===t&&(o=this.darkenColor(e,20)),n.style.background=`linear-gradient(135deg, ${o} 0%, ${this.darkenColor(o,10)} 100%)`,n.style.boxShadow=`0 6px 20px ${o}40, 0 2px 8px rgba(0, 0, 0, 0.1)`,"high"===t?n.classList.add("pulse-high-priority"):n.classList.remove("pulse-high-priority")}brightenColor(e,t){const n=parseInt(e.replace("#",""),16),o=Math.round(2.55*t),i=(n>>16)+o,s=(n>>8&255)+o,a=(255&n)+o;return"#"+(16777216+65536*(i<255?i:255)+256*(s<255?s:255)+(a<255?a:255)).toString(16).slice(1)}darkenColor(e,t){const n=parseInt(e.replace("#",""),16),o=Math.round(2.55*t),i=(n>>16)-o,s=(n>>8&255)-o,a=(255&n)-o;return"#"+(16777216+65536*(i<1?0:i)+256*(s<1?0:s)+(a<1?0:a)).toString(16).slice(1)}formatTimestamp(e){if(!e)return"Just now";const t=e.toDate?e.toDate():new Date(e),n=new Date-t,o=Math.floor(n/36e5),i=Math.floor(o/24);return o<1?"Just now":o<24?`${o} hour${o>1?"s":""} ago`:i<7?`${i} day${i>1?"s":""} ago`:t.toLocaleDateString("en-US",{month:"short",day:"numeric"})}destroy(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null)}}document.addEventListener("DOMContentLoaded",(()=>{void 0!==m?g=new w(m):console.error("Firebase db not found. Make sure Firebase is initialized first.")})),window.toggleNote=function(){g&&g.toggle()},window.updateNote=async function(e,t,n){if(m)try{const o=(0,i.H9)(m,"updateNotes","note#1"),s={isActive:!0,createdAt:(0,i.O5)(),createdBy:"admin"};void 0!==e&&(s.type=e),void 0!==t&&(s.message=t),void 0!==n&&(s.priority=n),await(0,i.mZ)(o,s),console.log("Note updated successfully")}catch(e){console.error("Error updating note:",e)}else console.error("Firebase not initialized")},window.hideNote=async function(){if(m)try{const e=(0,i.H9)(m,"updateNotes","note#1");await(0,i.mZ)(e,{isActive:!1}),console.log("Note hidden successfully")}catch(e){console.error("Error hiding note:",e)}else console.error("Firebase not initialized")};const b=new class{constructor(){this.cacheManager=new f,this.fetchInterval=3e5,this.isOnline=navigator.onLine,this.setupNetworkListeners()}setupNetworkListeners(){window.addEventListener("online",(()=>{this.isOnline=!0,this.fetchEventsIfNeeded(!0)})),window.addEventListener("offline",(()=>{this.isOnline=!1})),document.addEventListener("visibilitychange",(()=>{"visible"===document.visibilityState&&this.fetchEventsIfNeeded()}))}async fetchEventsIfNeeded(e=!1){Date.now();const t="events_data",n=this.cacheManager.get(t);if(!e&&n)return console.log("Using cached events data"),n;if(!e&&n&&this.isOnline)return console.log("Using memory cached events"),this.eventCache=n,n;if(!this.isOnline){const e=this.cacheManager.get("events_data");if(e)return console.log("Offline: using cached data"),e}try{console.log("Fetching fresh events data from Firebase");const e=await this.fetchEventsFromFirebase();return this.cacheManager.set(t,e,this.fetchInterval),e}catch(e){if(console.error("Error fetching events:",e),this.eventCache)return console.log("Error occurred: using cached events"),this.eventCache;throw e}}async fetchEventsFromFirebase(){const e=new Date;e.setDate(e.getDate()-60);const t=(0,i.P)(p,(0,i._M)("start",">=",e.toISOString().split("T")[0]),(0,i.My)("start","desc"),(0,i.AB)(50)),n=await(0,i.GG)(t),o=[];return n.docs.forEach((e=>{const t=this.processEventData(e);t&&o.push(t)})),o}processEventData(e){const t=(e.data().start||"").trim(),n=(e.data().end||"").trim(),o=e.data().startTime;let i,s,r,l;try{if(o){i=a().tz(`${t} ${o}`,"YYYY-MM-DD HH:mm","America/Los_Angeles");const c=e.data().endTime;s=c?a().tz(`${n} ${c}`,"YYYY-MM-DD HH:mm","America/Los_Angeles"):i.add(1,"hour"),r=i.tz(h),l=s.tz(h)}else{i=a().tz(t,"America/Los_Angeles").startOf("day"),s=a().tz(n,"America/Los_Angeles").endOf("day");const e=i.tz(h),o=s.tz(h);r=e.startOf("day"),l=o.startOf("day")}return r.isValid()&&l.isValid()?{id:e.id||this.generateEventId(e.data().title),title:e.data().title,start:i.toDate(),end:s.toDate(),allDay:!1,color:e.data().color,description:e.data().description,images:e.data().images,blogUrl:e.data().blogUrl,image:e.data().image,credits:e.data().credits,category:e.data().category||"special",emote:e.data().emote,memoryType:e.data().memoryType,location:e.data().location,realm:e.data().realm,note:e.data().note,spiritCount:e.data().spiritCount}:(console.warn("Skipping invalid event:",{id:e.id,startRaw:t,endRaw:n,startTime:o}),null)}catch(t){return console.warn("Error processing event:",e.id,t),null}}generateEventId(e){return e.toLowerCase().replace(/[^a-z0-9]/g,"-").replace(/-+/g,"-")}};function E(e,t,n,o,i){const s=document.createElement("div");return s.className=`event-notice ${t}`,s.innerHTML=`\n      <div class="notice-icon">\n        <img src="${n}" alt="${t} event icon" loading="lazy" >\n      </div>\n      <div class="notice-text">\n        <p><strong>${o}</strong> <u>${e.title}</u> ${i}</p>\n      </div>\n    `,s}function L(e){const t=e?.toLowerCase()||"";return console.log(e),t.includes("traveling")?{class:"ts",text:"TS"}:t.includes("season")?{class:"season",text:"SEASON"}:t.includes("special")?{class:"special",text:"SPECIAL"}:t.includes("days-of-events")?{class:"days",text:"DAYS OF"}:{class:"special",text:"EVENT"}}function x(e,t){const n={month:"short",day:"numeric"},o=e.toLocaleDateString("en-US",n),i=t.toLocaleDateString("en-US",n);if(e.getMonth()===t.getMonth()){const n=e.getDate(),o=t.getDate();return`${e.toLocaleDateString("en-US",{month:"short"})} ${n} - ${o}`}return`${o} - ${i}`}function C(e,t,n){const o=864e5,i=36e5;let s,a,r;if(n<e)s=e-n,a="Starts in",r="starting";else{if(!(n>=e&&n<=t))return{class:"ended",label:"Event",time:"Ended"};s=t-n,a="Ends in",r="ending"}const l=Math.floor(s/o),c=Math.floor(s%o/i),d=Math.floor(s%i/6e4);let u="";return u=l>0?`${l}d ${c}h ${d}m`:c>0?`${c}h ${d}m`:d>0?`${d}m`:"Now",{class:r,label:a,time:u}}document.addEventListener("DOMContentLoaded",(()=>{(async function(){try{console.log("Initializing optimized app...");const e=await b.fetchEventsIfNeeded();console.log(`Loaded ${e.length} events from cache/Firebase`),y=e,window.skyEventsManager?.setEventsData(e),function(e){const t=document.getElementById("calendar"),n=new FullCalendar.Calendar(t,{initialView:"dayGridMonth",fixedWeekCount:!1,aspectRatio:1.35,height:"auto",events:e,eventContent:function(e){const t=e.event.extendedProps.icon;return t?{html:`\n            <div class="event-icon-container">\n              <img src="${t}" class="event-icon" alt="event icon" loading="lazy"/>\n            </div>\n          `}:{html:`\n            <div class="event-content">\n              <span class="fc-event-title">${e.event.title}</span>\n            </div>\n          `}},eventOrder:"start",eventClick:function(e){T(e.event)},headerToolbar:{right:"prev,next today"}});n.render(),function(e,t){const n=document.createElement("select");n.id="category-filter",n.title="category-filter",n.innerHTML="\n        <option class='category-filter-option' value=\"\">All Categories</option>\n        <option class='category-filter-option' value=\"special-event\">Special Events</option>\n        <option class='category-filter-option' value=\"days-of-events\">Days of Events</option>\n        <option class='category-filter-option' value=\"travelling-spirits\">Travelling Spirits</option>\n        <option class='category-filter-option' value=\"seasons\">Seasons</option>\n    ",document.querySelector(".fc-toolbar-chunk:nth-child(2)").appendChild(n),n.addEventListener("change",(function(){const n=this.value.toLowerCase(),o=t.filter((e=>"hide"===n?!e.category||!e.category.toLowerCase().includes("shard"):e.category&&e.category.toLowerCase()===n||""===n));e.removeAllEventSources(),e.addEventSource(o)}))}(n,e)}(e),function(e){const t=document.querySelector(".info-container");t.innerHTML="";const n=document.createElement("div");n.innerHTML="<h2>Heads Up!</h2>",t.appendChild(n);const o=new Date,i=[],s=[];if(e.forEach((e=>{const t=new Date(e.start),n=new Date(e.end),a=Math.ceil((t-o)/864e5),r=Math.ceil((n-o)/864e5);a>0&&a<=4&&(e.daysUntil=a,i.push(e)),o>=t&&r>0&&r<=4&&(e.daysUntil=r,s.push(e))})),i.sort(((e,t)=>e.daysUntil-t.daysUntil)),s.sort(((e,t)=>e.daysUntil-t.daysUntil)),i.length>0)i.slice(0,2).forEach((e=>{const n=E(e,"upcoming","https://img.icons8.com/?size=100&id=FhnRPWu7HD5f&format=png&color=000000","Coming Soon:",`begins in ${e.daysUntil} day${e.daysUntil>1?"s":""}!`);t.appendChild(n)}));else if(0===i.length&&0===s.length){const e=function(e){const t=document.createElement("div");return t.className=`event-notice ${e}`,t.innerHTML=`\n      <div class="notice-icon">\n        <img src="https://img.icons8.com/?size=100&id=3ovMFy5JDSWq&format=png&color=000000" alt="${e} event icon" loading="lazy" >\n      </div>\n      <div class="notice-text">\n        <p>Relax! No events are starting or ending within the next 4 days.</p>\n      </div>\n    `,t}("upcoming");t.appendChild(e)}if(s.length>0&&s.slice(0,2).forEach((e=>{const n=E(e,"ending","https://img.icons8.com/?size=100&id=Sd2tYsgMJNyn&format=png&color=000000","Last Chance:",`ends in ${e.daysUntil} day${e.daysUntil>1?"s":""}!`);t.appendChild(n)})),0===i.length&&0===s.length){const e=document.querySelector(".heads-up");e&&(e.style.display="none")}}(e),function(e){const t=document.getElementById("event-cards-container");if(!t)return void console.warn("Quick overview container not found");t.innerHTML="";const n=new Date,o=e.filter((e=>new Date(e.end)>=n)).slice(0,6);1===o.length?t.classList.add("single-card"):t.classList.remove("single-card"),0!==o.length?o.forEach(((e,n)=>{const o=function(e){const t=document.createElement("div");t.className="event-card",t.setAttribute("data-event-id",e.id);const n=new Date,o=new Date(e.start),i=new Date(e.end);let s="";s=n<o?"upcoming":n>=o&&n<=i?"ongoing":"past",t.classList.add(s),t.style.borderBottom=`4px solid ${e.color}`;const a=L(e.category),r=x(o,i),l=C(o,i,n);return e.title.includes("Traveling Spirit:")&&(e.title=e.title.replace("Traveling Spirit:","TS:")),e.title.includes("Traveling Spirits")&&(e.title=e.title.replace("Traveling Spirits","TS")),t.innerHTML=`\n    <div class="event-image-container">\n      ${e.image?`<img src="${e.image}" alt="${e.title}" loading="lazy" class="event-image" onerror="this.parentElement.innerHTML='<div class=\\"event-image-placeholder\\">üåü</div>`:'<div class="event-image-placeholder">üåü</div>'}\n      <div class="event-badge ${a.class}">${a.text}</div>\n    </div>\n    <div class="event-content-overview">\n      <h3 class="event-title">${e.title.replace(/^[\p{Emoji}\p{Extended_Pictographic}]+\s*/u,"")}</h3>\n      <div class="event-date">${r}</div>\n      <div class="event-countdown ${l.class}">\n        <div class="countdown-label">${l.label}</div>\n        <div class="countdown-time">${l.time}</div>\n      </div>\n    </div>\n  `,t.addEventListener("click",(()=>{T(e)})),t}(e);o.style.animationDelay=.1*n+"s",t.appendChild(o)})):t.innerHTML='\n      <div class="empty-state">\n        <div class="empty-state-icon">üåü</div>\n        <div class="empty-state-text">No upcoming events</div>\n        <div class="empty-state-subtext">Check back soon for new Sky events!</div>\n      </div>\n    '}(e)}catch(e){console.error("Error initializing app: ",e),function(){const e=document.getElementById("eventsGrid");e&&(e.innerHTML='\n      <div class="empty-state" style="grid-column: 1 / -1; text-align: center; padding: 2rem;">\n        <div class="empty-state-icon" style="font-size: 3rem; margin-bottom: 1rem;">‚ö†Ô∏è</div>\n        <div class="empty-state-text" style="font-size: 1.25rem; font-weight: 600; margin-bottom: 0.5rem;">Failed to load events</div>\n        <div class="empty-state-subtext" style="color: var(--color-text-muted);">Please check your connection and try again.</div>\n        <button onclick="location.reload()" style="margin-top: 1rem; padding: 0.5rem 1rem; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;">Retry</button>\n      </div>\n    ')}()}})(),setInterval((async()=>{if("visible"===document.visibilityState&&navigator.onLine)try{const e=await b.fetchEventsIfNeeded();window.skyEventsManager&&window.skyEventsManager.setEventsData(e),"function"==typeof updateCalendarEvents&&updateCalendarEvents(e),console.log("Data refreshed successfully")}catch(e){console.error("Background refresh failed:",e)}}),6e5),void 0!==m&&(g=new w(m))})),window.optimizedEventManager=b;let k=setInterval((()=>{const e=document.querySelectorAll(".event-card-list");0!==e.length&&e.forEach((e=>{const t=e.getAttribute("data-event-id"),n=y.find((e=>e.id===t));if(n){const t=new Date,o=C(new Date(n.start),new Date(n.end),t),i=e.querySelector(".event-countdown"),s=e.querySelector(".countdown-label"),a=e.querySelector(".countdown-time");i&&s&&a&&(i.className=`event-countdown ${o.class}`,s.textContent=o.label,a.textContent=o.time)}}))}),6e4);window.addEventListener("beforeunload",(()=>{refreshInterval&&(clearInterval(refreshInterval),refreshInterval=null),k&&(clearInterval(k),k=null)}));let $=0,M=[];function T(e){const t=document.getElementById("eventModal"),n=document.getElementById("modalImageContainer"),o=document.getElementById("modalBadge"),i=document.getElementById("modalTitle"),s=document.getElementById("modalDescription"),a=document.getElementById("modalNote"),r=document.getElementById("modalShareBtn"),l=document.getElementById("modalCalendarBtn");!function(e,t){if(M=function(e){const t=[],n=e.extendedProps||{},o=D(S(e.images??n.images??[]));for(const e of o)t.push({url:e,type:N(e),source:"gallery"});const i=D(S(e.videos??n.videos??[]));for(const e of i)t.push({url:e,type:"video",source:"video"});const s=S(e.media??n.media??[]).map((e=>"string"==typeof e?{url:e}:e));for(const e of s){const n=e?.url;if(!n)continue;const o=e.type||N(n);t.some((e=>I(e.url)===I(n)))||t.push({url:n,type:o,source:"media"})}return t}(e),$=0,0===M.length)return void(t.innerHTML='<div class="modal-image-placeholder">üåü</div>');if(1===M.length){const n=M[0],o=B(n,e.title,!0);return void(t.innerHTML=`\n          ${o}\n          <div class="media-controls">\n            <button type="button" class="media-control-btn" onclick="downloadMedia('${n.url.replace(/'/g,"\\'")}')" title="Download">\n              üíæ\n            </button>\n            <button type="button" class="media-control-btn" onclick="openZoomModal('${n.url.replace(/'/g,"\\'")}', '${n.type}')" title="View Full Size">\n              üîç\n            </button>\n          </div>\n        `)}let n='\n        <div class="media-carousel">\n            <div class="media-slides" id="mediaSlides">\n    ';M.forEach(((t,o)=>{const i=B(t,e.title,0===o);n+=`<div class="media-slide">${i}</div>`})),n+='\n            </div>\n            <button type="button" class="carousel-nav prev" onclick="prevMedia()" id="prevBtn">‚Äπ</button>\n            <button type="button" class="carousel-nav next" onclick="nextMedia()" id="nextBtn">‚Ä∫</button>\n            <div class="media-controls">\n                <button type="button" class="media-control-btn" onclick="downloadCurrentMedia()" title="Download">\n                    üíæ\n                </button>\n                <button type="button" class="media-control-btn" onclick="openCurrentMediaZoom()" title="View Full Size">\n                    üîç\n                </button>\n            </div>\n            <div class="carousel-indicators" id="carouselIndicators">\n    ',M.forEach(((e,t)=>{n+=`<div class="carousel-indicator ${0===t?"active":""}" onclick="goToMedia(${t})"></div>`})),n+=`\n            </div>\n            <div class="media-counter">\n                <span id="mediaCounter">1 / ${M.length}</span>\n            </div>\n        </div>\n    `,t.innerHTML=n,F()}(e,n);const c=L(e.category||e.extendedProps&&e.extendedProps.category||"special");o.textContent=c.text,o.className=`modal-badge ${c.class}`;let d=e.title||"";d=d.replace("Traveling Spirit:","TS:"),d=d.replace("Traveling Spirits","TS"),d=d.replace(/^[\p{Emoji}\p{Extended_Pictographic}]+\s*/u,""),i.textContent=d,function(e){const t=document.getElementById("quickInfoSummary"),n=x(new Date(e.start),new Date(e.end||e.start)),o=e.extendedProps||{},i=t=>e[t]||o[t]||null,s=i("category")||"special";let a=[];if(a.push({icon:"üìÖ",label:"Date:",value:n}),"travelling-spirits"===s){const e=i("realm"),t=i("location"),n=i("memoryType"),o=i("emote");a.push({icon:"üåç",label:"Realm:",value:e||"To be announced"},{icon:"üìå",label:"Location:",value:t||"To be announced"},{icon:"üé≠",label:"Memory Type:",value:n||"N/A"},{icon:"üïäÔ∏è",label:"Emote:",value:o||"N/A"})}else if("seasons"===s){i("seasonType");const e=i("spiritCount");i("duration"),i("specialItems"),a.push({icon:"üë•",label:"Spirits:",value:e||"To be announced"})}else if("days-of-events"===s){const e=i("location");a.push({icon:"üìå",label:"Location:",value:e||"To be announced"})}else if("special-events"===s){const e=i("eventType"),t=i("activities"),n=i("rewards"),o=i("requirements");a.push({icon:"üéâ",label:"Event Type:",value:e||"Special Event"},{icon:"üéØ",label:"Activities:",value:t||"To be announced"},{icon:"üéÅ",label:"Rewards:",value:n||"To be announced"},{icon:"üìã",label:"Requirements:",value:o||"None specified"})}else if("group_ts"===s||e.title.toLowerCase().includes("traveling spirits")){const e=i("spiritCount"),t=i("realms"),n=i("duration");a.push({icon:"üë•",label:"Spirit Count:",value:e||"To be announced"},{icon:"üåç",label:"Realms:",value:t||"Multiple realms"},{icon:"‚è±Ô∏è",label:"Duration:",value:n||"To be announced"})}else{const e=i("eventType"),t=i("location");a.push({icon:"üéØ",label:"Event Type:",value:e||"General Event"},{icon:"üìå",label:"Location:",value:t||"To be announced"})}let r='<div class="quick-info-title">Quick Info Summary</div>';a.forEach((e=>{const t=e.value&&"N/A"!==e.value&&"To be announced"!==e.value&&"None specified"!==e.value?"info-value":"info-value na";r+=`\n            <div class="info-item">\n                <span class="info-icon">${e.icon}</span>\n                <span class="info-label">${e.label}</span>\n                <span class="${t}">${e.value}</span>\n            </div>\n        `})),t.innerHTML=r}(e);const u=e.description||e.extendedProps&&e.extendedProps.description;u&&u.trim()?s.innerHTML=`\n            <div class="description-title">Description</div>\n            <div class="description-content">${u}</div>\n        `:s.innerHTML='\n            <div class="description-title">Description</div>\n            <div class="description-content na">Information will be updated as it becomes available.</div>\n        ';const v=e.note||e.extendedProps&&e.extendedProps.note;v&&v.trim()?(a.innerHTML=`\n            <div class="note-title">Note</div>\n            <div class="modal-note-content">${v}</div>\n        `,a.style.display="block"):(a.innerHTML='\n            <div class="note-title">Reminder</div>\n            <div class="modal-note-content">Event details are subject to change. Please check back for updates.</div>\n        ',a.style.display="block"),r.onclick=()=>function(e){const t={title:e.title,text:`Check out this Sky: Children of the Light event: ${e.title}`,url:window.location.href};navigator.share&&navigator.canShare&&navigator.canShare(t)?navigator.share(t).catch((()=>{R(e)})):R(e)}(e),l.onclick=()=>function(e){const t=new Date(e.start),n=new Date(e.end||e.start),o=e=>e.toISOString().replace(/[-:]/g,"").replace(/\.\d{3}/,""),i=o(t),s=o(n);let a=e.title.replace("Traveling Spirit:","TS:");a=a.replace("Traveling Spirits","TS"),a=a.replace(/^[\p{Emoji}\p{Extended_Pictographic}]+\s*/u,"");const r=e.extendedProps||{};let l="Sky: Children of the Light Event\n\n";(r.realm||e.realm)&&(l+=`Realm: ${r.realm||e.realm}\n`),(r.location||e.location)&&(l+=`Location: ${r.location||e.location}\n`),(r.memoryType||e.memoryType)&&(l+=`Memory Type: ${r.memoryType||e.memoryType}\n`),(r.emote||e.emote)&&(l+=`Emote: ${r.emote||e.emote}\n`),(e.description||r.description)&&(l+=`\nDescription:\n${e.description||r.description}`);const c=`https://calendar.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(a)}&dates=${i}/${s}&details=${encodeURIComponent(l)}&location=${encodeURIComponent("Sky: Children of the Light")}`;window.open(c,"_blank")}(e),t.classList.add("active"),document.body.style.overflow="hidden"}function S(e){if(!e)return[];if(Array.isArray(e))return e;if("string"==typeof e){const t=e.trim();if(!t)return[];if(t.startsWith("[")&&t.endsWith("]")||t.startsWith('"')&&t.endsWith('"'))try{const e=JSON.parse(t);return Array.isArray(e)?e:[t]}catch(e){}return t.split(/[,|\n]/).map((e=>e.trim())).filter(Boolean)}return"object"==typeof e&&e.url?[e.url]:[]}function I(e){try{const t=new URL(e,window.location.href);return`${t.origin}${t.pathname}`}catch{return(e||"").split("?")[0]}}function D(e){const t=[],n=new Set;for(const o of e){const e="string"==typeof o?o:o?.url;if(!e)continue;const i=I(e);n.has(i)||(n.add(i),t.push(e))}return t}function N(e){const t=e.toLowerCase();return[".mp4",".webm",".ogg",".mov",".avi",".m4v",".3gp"].some((e=>t.includes(e)))?"video":t.includes(".gif")||t.includes(".webp")?"animated-image":"image"}function B(e,t,n=!1){const{url:o,type:i}=e,s=o.replace(/'/g,"&#39;").replace(/"/g,"&quot;");switch(i){case"video":return`\n                <video class="modal-video" ${n?"controls autoplay muted loop":"controls muted"}>\n                    <source src="${s}" type="${H(o)}">\n                    Your browser does not support the video tag.\n                </video>\n            `;case"animated-image":return`\n                <img loading="lazy"  src="${s}" alt="${t}" class="modal-image animated-image"\n                     onclick="openZoomModal('${s}', '${i}')"\n                     onerror="this.parentElement.innerHTML='<div class=&quot;media-error&quot;>Failed to load media</div>'">\n            `;default:return`\n                <img loading="lazy" src="${s}" alt="${t}" class="modal-image"\n                     onclick="openZoomModal('${s}', '${i}')"\n                     onerror="this.parentElement.innerHTML='<div class=&quot;media-error&quot;>Failed to load image</div>'">\n            `}}function P(){$>0&&($--,A())}function z(){$<M.length-1&&($++,A())}function A(){const e=document.getElementById("mediaSlides");if(!e)return;e.style.transform=`translateX(-${100*$}%)`,document.querySelectorAll(".carousel-indicator").forEach(((e,t)=>{e.classList.toggle("active",t===$)}));const t=document.getElementById("mediaCounter");t&&(t.textContent=`${$+1} / ${M.length}`),function(){document.querySelectorAll(".modal-video").forEach((e=>{e.pause()}));const e=document.querySelectorAll(".media-slide")[$];if(e){const t=e.querySelector(".modal-video");t&&t.play().catch((()=>{}))}}(),F()}function F(){const e=document.getElementById("prevBtn"),t=document.getElementById("nextBtn");e&&(e.disabled=0===$,e.style.opacity=0===$?"0.5":"1"),t&&(t.disabled=$===M.length-1,t.style.opacity=$===M.length-1?"0.5":"1")}function H(e){const t=e.toLowerCase();return t.includes(".mp4")?"video/mp4":t.includes(".webm")?"video/webm":t.includes(".ogg")?"video/ogg":t.includes(".mov")?"video/quicktime":t.includes(".avi")?"video/x-msvideo":"video/mp4"}function O(e){let t=e;if(e.includes("imagekit.io")){const n=e.includes("?")?"&":"?";t=`${e}${n}ik-attachment=true`}const n=document.createElement("a");n.href=t,n.download=function(e){try{return new URL(e).pathname.split("/").pop()||`sky-media-${Date.now()}`}catch(e){return`sky-media-${Date.now()}`}}(e),n.target="_blank",n.rel="noopener noreferrer",document.body.appendChild(n),n.click(),document.body.removeChild(n)}function q(e,t=null){let n=document.getElementById("zoomModal");n||(n=document.createElement("div"),n.id="zoomModal",n.className="zoom-modal",document.body.appendChild(n));const o=t||N(e),i=e.replace(/'/g,"&#39;").replace(/"/g,"&quot;");let s;switch(o){case"video":s=`\n                <div class="zoom-content">\n                    <video class="zoom-video" controls autoplay muted loop>\n                        <source src="${i}" type="${H(e)}">\n                        Your browser does not support the video tag.\n                    </video>\n                    <div class="zoom-controls">\n                        <button type="button" class="zoom-btn" onclick="downloadMedia('${i}')" title="Download">\n                            üíæ\n                        </button>\n                        <button type="button" class="zoom-btn" onclick="closeZoomModal()" title="Close">\n                            ‚úï\n                        </button>\n                    </div>\n                </div>\n            `;break;case"animated-image":s=`\n                <div class="zoom-content">\n                    <img loading="lazy"  src="${i}" alt="Zoomed animated image" class="zoom-image">\n                    <div class="zoom-controls">\n                        <button type="button" class="zoom-btn" onclick="downloadMedia('${i}')" title="Download">\n                            üíæ\n                        </button>\n                        <button type="button" class="zoom-btn" onclick="closeZoomModal()" title="Close">\n                            ‚úï\n                        </button>\n                    </div>\n                </div>\n            `;break;default:s=`\n                <div class="zoom-content">\n                    <img loading="lazy"  src="${i}" alt="Zoomed media" class="zoom-image">\n                    <div class="zoom-controls">\n                        <button type="button" class="zoom-btn" onclick="downloadMedia('${i}')" title="Download">\n                            üíæ\n                        </button>\n                        <button type="button" class="zoom-btn" onclick="closeZoomModal()" title="Close">\n                            ‚úï\n                        </button>\n                    </div>\n                </div>\n            `}n.innerHTML=s,n.classList.add("active"),document.body.style.overflow="hidden",n.onclick=e=>{e.target===n&&U()}}function U(){const e=document.getElementById("zoomModal");if(e){const t=e.querySelector(".zoom-video");t&&t.pause(),e.classList.remove("active"),document.getElementById("eventModal").classList.contains("active")||(document.body.style.overflow="")}}function Z(){const e=document.getElementById("eventModal");e.classList.remove("active"),document.body.style.overflow="",e.querySelectorAll(".modal-video").forEach((e=>{e.pause()}))}function R(e){const t=`${e.title}\n${x(new Date(e.start),new Date(e.end||e.start))}\n${window.location.href}`;navigator.clipboard?navigator.clipboard.writeText(t).then((()=>{V("Event details copied to clipboard!")})).catch((()=>{_(t)})):_(t)}function _(e){const t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.left="-999999px",t.style.top="-999999px",document.body.appendChild(t),t.focus(),t.select();try{document.execCommand("copy"),V("Event details copied to clipboard!")}catch(e){V("Unable to copy to clipboard")}finally{document.body.removeChild(t)}}function V(e){const t=document.createElement("div");t.style.cssText="\n        position: fixed;\n        top: 20px;\n        right: 20px;\n        background: #333;\n        color: white;\n        padding: 12px 16px;\n        border-radius: 8px;\n        z-index: 10000;\n        font-size: 0.9rem;\n        box-shadow: 0 4px 12px rgba(0,0,0,0.3);\n        transition: opacity 0.3s ease;\n    ",t.textContent=e,document.body.appendChild(t),setTimeout((()=>{t.style.opacity="0",setTimeout((()=>{t.parentNode&&document.body.removeChild(t)}),300)}),3e3)}document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("closeModal");e&&e.addEventListener("click",Z);const t=document.getElementById("eventModal");t&&t.addEventListener("click",(e=>{e.target.classList.contains("modal-overlay")&&Z()})),document.addEventListener("keydown",(e=>{if("Escape"===e.key){const e=document.getElementById("eventModal"),t=document.getElementById("zoomModal");t&&t.classList.contains("active")?U():e&&e.classList.contains("active")&&Z()}})),document.addEventListener("keydown",(e=>{const t=document.getElementById("eventModal");t&&t.classList.contains("active")&&("ArrowLeft"===e.key?(e.preventDefault(),P()):"ArrowRight"===e.key&&(e.preventDefault(),z()))}))})),window.openEventModal=T,window.closeEventModal=Z,window.downloadMedia=O,window.openZoomModal=q,window.nextMedia=z,window.prevMedia=P,window.goToMedia=function(e){e>=0&&e<M.length&&($=e,A())},window.downloadCurrentMedia=function(){M[$]&&O(M[$].url)},window.openCurrentMediaZoom=function(){if(M[$]){const e=M[$];q(e.url,e.type)}},window.closeZoomModal=U;class Y{constructor(){this.events=[],this.allEvents=[],this.favorites=JSON.parse(localStorage.getItem("skyEventsFavorites")||"[]"),this.currentFilter="all",this.searchTerm="",this.countdownIntervals=new Map,this.calendar=null,this.currentPage=1,this.eventsPerPage=6,this.filteredEvents=[],this.init()}init(){this.setupEventListeners(),this.initializeFilters(),this.createPaginationContainer()}setEventsData(e){this.allEvents=e,this.events=this.convertFirebaseEventsToCardFormat(e),this.filterEvents(),this.renderCurrentPage()}convertFirebaseEventsToCardFormat(e){return e.map((e=>({id:e.id,title:e.title,description:e.description||"",category:e.category||"special",start:e.start,end:e.end,allDay:e.allDay,color:e.color,image:e.image,images:e.images,blogUrl:e.blogUrl,credits:e.credits,emote:e.emote,realm:e.realm,location:e.location,memoryType:e.memoryType,note:e.note,spiritCount:e.spiritCount}))).sort(((e,t)=>{const n=new Date(e.start);return new Date(t.start)-n}))}filterEvents(){this.filteredEvents=this.events.filter((e=>{const t=new Date,n=new Date(e.start),o=new Date(e.end),i=t>=n&&t<=o,s=t<=n,a="all"===this.currentFilter||this.currentFilter===e.category||"favorites"===this.currentFilter&&this.favorites.includes(e.id)||"in-progress"===this.currentFilter&&i||"coming-soon"===this.currentFilter&&s,r=this.searchTerm.toLowerCase(),l=""===this.searchTerm||e.title.toLowerCase().includes(r);return a&&l})),this.currentPage=1}getCurrentPageEvents(){const e=(this.currentPage-1)*this.eventsPerPage,t=e+this.eventsPerPage;return this.filteredEvents.slice(e,t)}getTotalPages(){return Math.ceil(this.filteredEvents.length/this.eventsPerPage)}renderCurrentPage(){const e=document.getElementById("eventsGrid");if(!e)return;e.innerHTML="";const t=this.getCurrentPageEvents();if(0===t.length)return this.showEmptyState(),void this.updatePagination();t.forEach((t=>{const n=this.createEventCard(t);e.appendChild(n)})),this.updateFavoriteButtons(),this.updatePagination(),setTimeout((()=>{this.startCountdowns()}),50)}createEventCard(e){const t=document.createElement("div");t.className=`event-list-card ${e.category}`,t.dataset.eventId=e.id,t.dataset.category=e.category;const n=new Date,o=new Date(e.start),i=new Date(e.end),s=n>=o&&n<=i,a=n<o,r=this.getCategoryBadge(e.category),l=this.getCategoryIcon(e.category);let c="ended",d="Event Ended";return s?(c="active",d="Active Now"):a?(c="upcoming",d="Coming Soon"):e.recurring&&(c="recurring",d="Recurring"),t.innerHTML=`\n      <div class="event-list-icon">\n        ${l}\n      </div>\n      \n      <div class="event-list-content">\n        <div class="event-list-badge">\n          <span class="event-list-badge-item ${e.category}-badge">${r}</span>\n          <div class="event-list-status ${c}">${d}</div>\n        </div>\n        <h3 class="event-list-title">${e.title}</h3>\n        <div class="event-list-dates">${this.formatDateRange(o,i)}</div>\n        \n        <div class="event-list-actions">\n          <button type="button" class="event-list-btn event-list-btn-primary" onclick="openEventModal(${JSON.stringify(e).replace(/"/g,"&quot;")})">\n            View Details\n          </button>\n          <button type="button" class="event-list-btn event-list-btn-secondary event-list-favorite-btn" data-event-id="${e.id}">\n            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n              <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>\n            </svg>\n          </button>\n        </div>\n      </div>\n    `,t}formatDateRange(e,t){const n=this.formatDate(e),o=this.formatDate(t);if(e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()){const n=e.getDate(),o=t.getDate(),i=e.toLocaleDateString("en-US",{month:"short"}),s=e.getFullYear();return n===o?`${i} ${n}, ${s}`:`${i} ${n} - ${o}, ${s}`}return`${n} - ${o}`}getCategoryBadge(e){const t={seasons:"Season","travelling-spirits":"Traveling Spirit","special-event":"Special Event","days-of-events":"Days of Event",default:"Event"};return t[e]||t.default}getCategoryIcon(e){const t={seasons:'<svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">\n        <path d="M12 2L15.5 8.5L22 12L15.5 15.5L12 22L8.5 15.5L2 12L8.5 8.5L12 2Z"/>\n      </svg>',"travelling-spirits":'<svg width="24" height="24" viewBox="0 0 48 48" fill="currentColor" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">\n          <path d="M24 4L29 14L44 24L29 34L24 44L19 34L4 24L19 14L24 4Z"/>\n          <path d="M12 6L14 10L18 12L14 14L12 18L10 14L6 12L10 10L12 6Z"/>\n          <path d="M36 30L38 34L42 36L38 38L36 42L34 38L30 36L34 34L36 30Z"/>\n        </svg>',"special-event":'<svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">\n            <rect x="9" y="10" width="6" height="12" rx="1"/>\n            <path d="M12 2C13.2 4 14 5.5 14 7C14 8.66 13 10 12 10C11 10 10 8.66 10 7C10 5.5 10.8 4 12 2Z"/>\n          </svg>',"days-of-events":'<svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">\n        <path d="M19 3H18V1H16V3H8V1H6V3H5C3.89 3 3.01 3.9 3.01 5L3 19C3 20.1 3.89 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM19 19H5V8H19V19Z"/>\n      </svg>',default:'<svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">\n        <path d="M12 2L15.5 8.5L22 12L15.5 15.5L12 22L8.5 15.5L2 12L8.5 8.5L12 2Z"/>\n      </svg>'};return t[e]||t.default}generateCountdownHtml(e,t,n,o){return o?'\n        <div class="event-list-countdown event-list-countdown-ended">\n          <div class="event-list-countdown-content">\n            <div class="event-list-countdown-header">Event</div>\n            <div class="event-list-countdown-time">Ended</div>\n          </div>\n        </div>\n      ':`\n      <div class="event-list-countdown ${t?"event-list-countdown-active":"event-list-countdown-upcoming"}" data-target-date="${t?e.end:e.start}">\n        <div class="event-list-countdown-content">\n          <div class="event-list-countdown-header">${t?"Ends In":"Starts In"}</div>\n          <div class="event-list-countdown-time">--D --H --M</div>\n        </div>\n      </div>\n    `}formatDate(e){return e.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:0!==e.getHours()?"numeric":void 0,minute:0!==e.getHours()?"2-digit":void 0})}setupEventListeners(){document.addEventListener("input",(e=>{("eventListSearch"===e.target.id||e.target.classList.contains("event-list-search-input"))&&(this.searchTerm=e.target.value.toLowerCase(),this.filterEvents(),this.renderCurrentPage())})),document.addEventListener("click",(e=>{if(e.target.classList.contains("event-list-filter-btn")&&this.handleFilterClick(e.target),e.target.closest(".event-list-favorite-btn")&&this.handleFavoriteClick(e.target.closest(".event-list-favorite-btn")),e.target.classList.contains("pagination-btn")){const t=parseInt(e.target.dataset.page);t&&t!==this.currentPage&&(this.currentPage=t,this.renderCurrentPage(),setTimeout((()=>{this.startCountdowns()}),100))}e.target.classList.contains("pagination-prev")&&this.currentPage>1&&(this.currentPage--,this.renderCurrentPage(),setTimeout((()=>{this.startCountdowns()}),100)),e.target.classList.contains("pagination-next")&&this.currentPage<this.getTotalPages()&&(this.currentPage++,this.renderCurrentPage(),setTimeout((()=>{this.startCountdowns()}),100))}));const e=document.querySelector(".event-list-theme-toggle");e&&e.addEventListener("click",this.toggleTheme)}handleFilterClick(e){document.querySelectorAll(".event-list-filter-btn").forEach((e=>e.classList.remove("active"))),e.classList.add("active"),this.currentFilter=e.dataset.filter,this.filterEvents(),this.renderCurrentPage(),setTimeout((()=>{this.startCountdowns()}),100)}handleFavoriteClick(e){const t=e.dataset.eventId,n=this.favorites.indexOf(t);n>-1?(this.favorites.splice(n,1),e.classList.remove("favorited")):(this.favorites.push(t),e.classList.add("favorited")),localStorage.setItem("skyEventsFavorites",JSON.stringify(this.favorites)),this.updateFavoriteButton(e,t)}updateFavoriteButton(e,t){const n=this.favorites.includes(t);e.classList.toggle("favorited",n),e.style.transform="scale(1.2)",setTimeout((()=>{e.style.transform=""}),150)}showEmptyState(){const e=document.getElementById("eventsGrid");if(!e)return;let t='\n      <div class="event-list-empty-message">\n        <div class="empty-state">\n    ';this.searchTerm?t+='\n        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n          <circle cx="11" cy="11" r="8"/>\n          <path d="m21 21-4.35-4.35"/>\n        </svg>\n        <h3>No events found</h3>\n        <p>Try adjusting your search terms or filters</p>\n      ':"favorites"===this.currentFilter?t+='\n        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n          <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>\n        </svg>\n        <h3>No favorite events</h3>\n        <p>Start adding events to your favorites by clicking the heart icon</p>\n      ':t+='\n        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n          <path d="M12,2L13.5,7.5L19,9L13.5,10.5L12,16L10.5,10.5L5,9L10.5,7.5L12,2Z"/>\n        </svg>\n        <h3>No events in this category</h3>\n        <p>Try selecting a different filter</p>\n      ',t+="\n        </div>\n      </div>\n    ",e.innerHTML=t}updateFavoriteButtons(){document.querySelectorAll(".event-list-favorite-btn").forEach((e=>{const t=e.dataset.eventId;this.favorites.includes(t)&&e.classList.add("favorited")}))}createPaginationContainer(){let e=document.querySelector(".event-list-pagination");if(!e){e=document.createElement("div"),e.className="event-list-pagination";const t=document.getElementById("eventsGrid");t&&t.parentNode&&t.parentNode.insertBefore(e,t.nextSibling)}}updatePagination(){const e=document.querySelector(".event-list-pagination");if(!e)return;const t=this.getTotalPages();if(t<=1)return void(e.innerHTML="");let n=`\n      <div class="pagination-info">\n        Showing ${(this.currentPage-1)*this.eventsPerPage+1}-${Math.min(this.currentPage*this.eventsPerPage,this.filteredEvents.length)} of ${this.filteredEvents.length} events\n      </div>\n      <div class="pagination-controls">\n        <button type="button" class="pagination-btn pagination-prev" ${1===this.currentPage?"disabled":""}>\n          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n            <polyline points="15,18 9,12 15,6"></polyline>\n          </svg>\n          Previous\n        </button>\n    `,o=Math.max(1,this.currentPage-Math.floor(2.5)),i=Math.min(t,o+5-1);i-o<4&&(o=Math.max(1,i-5+1)),o>1&&(n+='<button type="button" class="pagination-btn" data-page="1">1</button>',o>2&&(n+='<span class="pagination-ellipsis">...</span>'));for(let e=o;e<=i;e++)n+=`\n        <button type="button" class="pagination-btn ${e===this.currentPage?"active":""}" data-page="${e}">\n          ${e}\n        </button>\n      `;i<t&&(i<t-1&&(n+='<span class="pagination-ellipsis">...</span>'),n+=`<button type="button" class="pagination-btn" data-page="${t}">${t}</button>`),n+=`\n        <button type="button" class="pagination-btn pagination-next" ${this.currentPage===t?"disabled":""}>\n          Next\n          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n            <polyline points="9,18 15,12 9,6"></polyline>\n          </svg>\n        </button>\n      </div>\n    `,e.innerHTML=n}initializeFilters(){let e=document.querySelector(".event-list-filters");if(!e){e=document.createElement("div"),e.className="event-list-filters";const t=document.getElementById("eventsGrid");t&&t.parentNode.insertBefore(e,t)}e.innerHTML=[{key:"all",label:"All Events"},{key:"seasons",label:"Seasons"},{key:"travelling-spirits",label:"Traveling Spirits"},{key:"special-event",label:"Special Events"},{key:"days-of-events",label:"Days of Events"},{key:"favorites",label:"Favorites"},{key:"in-progress",label:"In Progress"},{key:"coming-soon",label:"Coming Soon"}].map((e=>`<button type="button" class="event-list-filter-btn ${"all"===e.key?"active":""}" data-filter="${e.key}">\n        ${e.label}\n      </button>`)).join("")}startCountdowns(){this.countdownIntervals.forEach((e=>clearInterval(e))),this.countdownIntervals.clear(),document.querySelectorAll(".event-list-countdown").forEach((e=>{if(e.classList.contains("event-list-countdown-ended"))return;const t=e.closest(".event-list-card");if(!t)return;const n=t.dataset.eventId,o=e.dataset.targetDate;if(o&&n){const t=setInterval((()=>{this.updateCountdown(e,o)}),1e3);this.countdownIntervals.set(n,t),this.updateCountdown(e,o)}}))}updateCountdown(e,t){const n=(new Date).getTime(),o=new Date(t).getTime()-n;if(o<0)return e.innerHTML='\n        <div class="event-list-countdown-content">\n          <div class="event-list-countdown-header">Event</div>\n          <div class="event-list-countdown-time">Ended</div>\n        </div>\n      ',void(e.className="event-list-countdown event-list-countdown-ended");const i=Math.floor(o/864e5),s=Math.floor(o%864e5/36e5),a=Math.floor(o%36e5/6e4),r=e.querySelector(".event-list-countdown-time");if(r){const e=`${i}D ${s}H ${a}M`;r.textContent=e}}toggleTheme(){const e="dark"===document.documentElement.getAttribute("data-theme")?"light":"dark";document.documentElement.setAttribute("data-theme",e),localStorage.setItem("skyEventsTheme",e)}setupNotifications(){"Notification"in window&&Notification.requestPermission()}scheduleEventNotification(e,t=30){const n=new Date(e.startDate||e.nextOccurrence),o=new Date(n.getTime()-60*t*1e3),i=new Date;if(o>i){const n=o.getTime()-i.getTime();setTimeout((()=>{"granted"===Notification.permission&&new Notification("Sky COTL Event Reminder",{body:`${e.title} starts in ${t} minutes!`,icon:"/favicon.ico",badge:"/favicon.ico"})}),n)}}destroy(){this.countdownIntervals.forEach((e=>clearInterval(e))),this.countdownIntervals.clear(),this.calendar&&this.calendar.destroy()}}document.addEventListener("DOMContentLoaded",(()=>{const e=localStorage.getItem("skyEventsTheme")||"light";document.documentElement.setAttribute("data-theme",e),window.skyEventsManager=new Y,setTimeout((()=>{if(!document.getElementById("eventListSearch")){const e=document.createElement("div");e.className="event-list-search-container",e.innerHTML='\n        <input \n          type="text" \n          id="eventListSearch" \n          class="event-list-search-input" \n          placeholder="Search events..." \n          aria-label="Search events"\n        >\n      ';const t=document.getElementById("eventsGrid");t&&t.parentNode.insertBefore(e,t)}}),100)})),e.exports&&(e.exports=Y),window.toggleNote=function(){g&&g.toggle()},window.updateNote=async function(e,t,n){if(m)try{const o=(0,i.H9)(m,"updateNotes","note#1"),s={isActive:!0,createdAt:(0,i.O5)(),createdBy:"admin"};void 0!==e&&(s.type=e),void 0!==t&&(s.message=t),void 0!==n&&(s.priority=n),await(0,i.mZ)(o,s),console.log("Note updated successfully")}catch(e){console.error("Error updating note:",e)}else console.error("Firebase not initialized")},window.hideNote=async function(){if(m)try{const e=(0,i.H9)(m,"updateNotes","note#1");await(0,i.mZ)(e,{isActive:!1}),console.log("Note hidden successfully")}catch(e){console.error("Error hiding note:",e)}else console.error("Firebase not initialized")}}},n={};function o(e){var i=n[e];if(void 0!==i)return i.exports;var s=n[e]={id:e,loaded:!1,exports:{}};return t[e].call(s.exports,s,s.exports,o),s.loaded=!0,s.exports}o.m=t,e=[],o.O=(t,n,i,s)=>{if(!n){var a=1/0;for(d=0;d<e.length;d++){for(var[n,i,s]=e[d],r=!0,l=0;l<n.length;l++)(!1&s||a>=s)&&Object.keys(o.O).every((e=>o.O[e](n[l])))?n.splice(l--,1):(r=!1,s<a&&(a=s));if(r){e.splice(d--,1);var c=i();void 0!==c&&(t=c)}}return t}s=s||0;for(var d=e.length;d>0&&e[d-1][2]>s;d--)e[d]=e[d-1];e[d]=[n,i,s]},o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={57:0};o.O.j=t=>0===e[t];var t=(t,n)=>{var i,s,[a,r,l]=n,c=0;if(a.some((t=>0!==e[t]))){for(i in r)o.o(r,i)&&(o.m[i]=r[i]);if(l)var d=l(o)}for(t&&t(n);c<a.length;c++)s=a[c],o.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return o.O(d)},n=self.webpackChunkthat_sky_calendar=self.webpackChunkthat_sky_calendar||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var i=o.O(void 0,[424,252,96],(()=>o(44)));i=o.O(i)})();